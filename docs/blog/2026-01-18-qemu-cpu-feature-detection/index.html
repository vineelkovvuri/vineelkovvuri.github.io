<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>QEMU CPU Feature Detection | Vineel Kovvuri</title>
    
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    <link rel="stylesheet" href="/css/copy-button.css" />
    <link rel="stylesheet" href="/css/forms.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Sans:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
    <link rel="shortcut icon" href="/images/favicon.ico" />
    <link href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css" rel="stylesheet">

  </head>

  <body>
    <nav>
    <ul class="menu">
      
      <li><a href="/">Home</a></li>
      
      <li><a href="/blog/">Blog</a></li>
      
      <li><a href="/projects/">Projects</a></li>
      
      <li><a href="/bookmarks/">Bookmarks</a></li>
      
    </ul>
    <hr/>
    </nav>

<div class="article-meta">
<h1><span class="title">QEMU CPU Feature Detection</span></h1>


<h3 class="date">
    2026/01/18
    
        |
        <a href="/tags/general">General</a>
        
    
</h3>

</div>



<main>
<p>QEMU is an amazing tool for developing embedded software. Many times, we need to
determine the feature set supported by a chosen CPU. Below is a quick and
practical way to do that.</p>
<p>For example, on the x86 QEMU system emulator, we can first list the available
x64 CPU models using the following command:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cmd" data-lang="cmd"><span style="display:flex;"><span>D:<span style="color:#369;font-style:italic">\</span><span style="color:#888">&gt; qemu-system-x86_64.exe -cpu help</span>
</span></span><span style="display:flex;"><span>Available CPUs:
</span></span><span style="display:flex;"><span>  486                   (alias configured by machine type)
</span></span><span style="display:flex;"><span>  486-v1
</span></span><span style="display:flex;"><span>  Broadwell             (alias configured by machine type)
</span></span><span style="display:flex;"><span>  Broadwell-IBRS        (alias of Broadwell-v3)
</span></span><span style="display:flex;"><span>  Broadwell-noTSX       (alias of Broadwell-v2)
</span></span><span style="display:flex;"><span>  Broadwell-noTSX-IBRS  (alias of Broadwell-v4)
</span></span><span style="display:flex;"><span>  Broadwell-v1          Intel Core Processor (Broadwell)
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>  EPYC-v1               AMD EPYC Processor
</span></span><span style="display:flex;"><span>  EPYC-v2               AMD EPYC Processor (with IBPB)
</span></span><span style="display:flex;"><span>  EPYC-v3               AMD EPYC Processor
</span></span><span style="display:flex;"><span>  EPYC-v4               AMD EPYC-v4 Processor
</span></span><span style="display:flex;"><span>  EPYC-v5               AMD EPYC-v5 Processor
</span></span><span style="display:flex;"><span>  GraniteRapids         (alias configured by machine type)
</span></span><span style="display:flex;"><span>  GraniteRapids-v1      Intel Xeon Processor (GraniteRapids)
</span></span><span style="display:flex;"><span>  GraniteRapids-v2      Intel Xeon Processor (GraniteRapids)
</span></span><span style="display:flex;"><span>  GraniteRapids-v3      Intel Xeon Processor (GraniteRapids) [with gnr-sp cache model and 0x1f leaf]
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>  Skylake-Client        (alias configured by machine type)
</span></span><span style="display:flex;"><span>  Skylake-Client-IBRS   (alias of Skylake-Client-v2)
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>  kvm32                 (alias configured by machine type)
</span></span><span style="display:flex;"><span>  kvm32-v1              Common 32-bit KVM processor
</span></span><span style="display:flex;"><span>  kvm64                 (alias configured by machine type)
</span></span><span style="display:flex;"><span>  kvm64-v1              Common KVM processor
</span></span><span style="display:flex;"><span>  pentium               (alias configured by machine type)
</span></span><span style="display:flex;"><span>  pentium-v1
</span></span><span style="display:flex;"><span>  pentium2              (alias configured by machine type)
</span></span><span style="display:flex;"><span>  pentium2-v1
</span></span><span style="display:flex;"><span>  pentium3              (alias configured by machine type)
</span></span><span style="display:flex;"><span>  pentium3-v1
</span></span><span style="display:flex;"><span>  phenom                (alias configured by machine type)
</span></span><span style="display:flex;"><span>  phenom-v1             AMD Phenom(tm) 9550 Quad-Core Processor
</span></span><span style="display:flex;"><span>  qemu32                (alias configured by machine type)
</span></span><span style="display:flex;"><span>  qemu32-v1             QEMU Virtual CPU version 2.5+
</span></span><span style="display:flex;"><span>  qemu64                (alias configured by machine type)
</span></span><span style="display:flex;"><span>  qemu64-v1             QEMU Virtual CPU version 2.5+
</span></span><span style="display:flex;"><span>  base                  base CPU model type with no features enabled
</span></span><span style="display:flex;"><span>  host                  processor with all supported host features
</span></span><span style="display:flex;"><span>  max                   Enables all features supported by the accelerator on the current host
</span></span></code></pre></div><p>Next, the script below can be used to determine the CPU features supported by a
chosen CPU model.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#888"># Start QEMU with QMP in the background</span>
</span></span><span style="display:flex;"><span><span style="color:#038">Start-Process</span> <span style="color:#038">qemu-system</span>-x86_64.<span style="color:#369;font-weight:bold">exe</span> `
</span></span><span style="display:flex;"><span>    -ArgumentList <span style="color:#d20;background-color:#fff0f0">&#34;-S -qmp tcp:127.0.0.1:4444,server,nowait&#34;</span> `
</span></span><span style="display:flex;"><span>    -NoNewWindow
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#888"># Wait for QEMU to start</span>
</span></span><span style="display:flex;"><span><span style="color:#038">Start-Sleep</span> -Seconds <span style="color:#00d;font-weight:bold">5</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#888"># Connect to the QMP socket</span>
</span></span><span style="display:flex;"><span><span style="color:#369">$client</span> = <span style="color:#038">New-Object</span> System.<span style="color:#369;font-weight:bold">Net</span>.<span style="color:#369;font-weight:bold">Sockets</span>.<span style="color:#369;font-weight:bold">TcpClient</span>(<span style="color:#d20;background-color:#fff0f0">&#34;127.0.0.1&#34;</span>, <span style="color:#00d;font-weight:bold">4444</span>)
</span></span><span style="display:flex;"><span><span style="color:#369">$stream</span> = <span style="color:#369">$client</span>.<span style="color:#369;font-weight:bold">GetStream</span>()
</span></span><span style="display:flex;"><span><span style="color:#369">$reader</span> = <span style="color:#038">New-Object</span> System.<span style="color:#369;font-weight:bold">IO</span>.<span style="color:#369;font-weight:bold">StreamReader</span>(<span style="color:#369">$stream</span>)
</span></span><span style="display:flex;"><span><span style="color:#369">$writer</span> = <span style="color:#038">New-Object</span> System.<span style="color:#369;font-weight:bold">IO</span>.<span style="color:#369;font-weight:bold">StreamWriter</span>(<span style="color:#369">$stream</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#888"># Read the QMP greeting</span>
</span></span><span style="display:flex;"><span><span style="color:#369">$reader</span>.<span style="color:#369;font-weight:bold">ReadLine</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#888"># Enable QMP capabilities</span>
</span></span><span style="display:flex;"><span><span style="color:#369">$writer</span>.<span style="color:#369;font-weight:bold">WriteLine</span>(<span style="color:#d20;background-color:#fff0f0">&#39;{&#34;execute&#34;: &#34;qmp_capabilities&#34;}&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#369">$writer</span>.<span style="color:#369;font-weight:bold">Flush</span>()
</span></span><span style="display:flex;"><span><span style="color:#369">$reader</span>.<span style="color:#369;font-weight:bold">ReadLine</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#888"># Query the features supported by a given CPU (qemu64 in this example)</span>
</span></span><span style="display:flex;"><span><span style="color:#369">$writer</span>.<span style="color:#369;font-weight:bold">WriteLine</span>(<span style="color:#d20;background-color:#fff0f0">&#39;{&#34;execute&#34;: &#34;query-cpu-model-expansion&#34;, &#34;arguments&#34;: {&#34;type&#34;: &#34;full&#34;, &#34;model&#34;: {&#34;name&#34;: &#34;qemu64&#34;}}}&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#369">$writer</span>.<span style="color:#369;font-weight:bold">Flush</span>()
</span></span><span style="display:flex;"><span><span style="color:#369">$reader</span>.<span style="color:#369;font-weight:bold">ReadLine</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#369">$client</span>.<span style="color:#369;font-weight:bold">Close</span>()
</span></span></code></pre></div><p>Below is the feature set supported by the <code>qemu64</code> CPU model. These features can
be enabled or disabled using <code>+feature</code> and <code>-feature</code> in the QEMU command line.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#b06;font-weight:bold">&#34;return&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#b06;font-weight:bold">&#34;model&#34;</span>: {
</span></span><span style="display:flex;"><span>            <span style="color:#b06;font-weight:bold">&#34;name&#34;</span>: <span style="color:#d20;background-color:#fff0f0">&#34;qemu64&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#b06;font-weight:bold">&#34;props&#34;</span>: {
</span></span><span style="display:flex;"><span>                <span style="color:#b06;font-weight:bold">&#34;3dnow&#34;</span>: <span style="color:#080;font-weight:bold">false</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#b06;font-weight:bold">&#34;3dnowext&#34;</span>: <span style="color:#080;font-weight:bold">false</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#b06;font-weight:bold">&#34;3dnowprefetch&#34;</span>: <span style="color:#080;font-weight:bold">false</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#b06;font-weight:bold">&#34;abm&#34;</span>: <span style="color:#080;font-weight:bold">false</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#b06;font-weight:bold">&#34;ace2-en&#34;</span>: <span style="color:#080;font-weight:bold">false</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#b06;font-weight:bold">&#34;ace2&#34;</span>: <span style="color:#080;font-weight:bold">false</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#b06;font-weight:bold">&#34;acpi&#34;</span>: <span style="color:#080;font-weight:bold">false</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#a61717;background-color:#e3d2d2">...</span>
</span></span><span style="display:flex;"><span>                <span style="color:#b06;font-weight:bold">&#34;xfd&#34;</span>: <span style="color:#080;font-weight:bold">false</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#b06;font-weight:bold">&#34;xgetbv1&#34;</span>: <span style="color:#080;font-weight:bold">false</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#b06;font-weight:bold">&#34;xlevel&#34;</span>: <span style="color:#00d;font-weight:bold">2147483658</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#b06;font-weight:bold">&#34;xlevel2&#34;</span>: <span style="color:#00d;font-weight:bold">0</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#b06;font-weight:bold">&#34;xop&#34;</span>: <span style="color:#080;font-weight:bold">false</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#b06;font-weight:bold">&#34;xsave&#34;</span>: <span style="color:#080;font-weight:bold">false</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#b06;font-weight:bold">&#34;xsavec&#34;</span>: <span style="color:#080;font-weight:bold">false</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#b06;font-weight:bold">&#34;xsaveerptr&#34;</span>: <span style="color:#080;font-weight:bold">false</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#b06;font-weight:bold">&#34;xsaveopt&#34;</span>: <span style="color:#080;font-weight:bold">false</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#b06;font-weight:bold">&#34;xsaves&#34;</span>: <span style="color:#080;font-weight:bold">false</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#b06;font-weight:bold">&#34;xstore-en&#34;</span>: <span style="color:#080;font-weight:bold">false</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#b06;font-weight:bold">&#34;xstore&#34;</span>: <span style="color:#080;font-weight:bold">false</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#b06;font-weight:bold">&#34;xtpr&#34;</span>: <span style="color:#080;font-weight:bold">false</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#b06;font-weight:bold">&#34;zero-fcs-fds&#34;</span>: <span style="color:#080;font-weight:bold">false</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div>
</main>

<hr/>

<section id="comments" class="giscus">
  <script src="https://giscus.app/client.js"
    data-repo="vineelkovvuri/vineelkovvuri.github.io"
    data-repo-id="R_kgDOLIbzLw"
    data-category="General"
    data-category-id="DIC_kwDOLIbzL84CwjtF"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="preferred_color_scheme"
    data-lang="en"
    data-loading="lazy"
    crossorigin="anonymous"
    async>
  </script>
</section>

  <footer>
  
<script defer src="/js/center-img.js"></script>
<script defer src="/js/pre-tag.js"></script>







  
  <hr/>
  © Vineel Kumar Reddy Kovvuri 2017 &ndash; 2026 ❤️ <a href="https://xmin.yihui.org/">Hugo Xmin</a>
  
  </footer>
  </body>
</html>

