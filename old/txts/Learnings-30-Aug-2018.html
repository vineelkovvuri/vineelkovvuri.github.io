<!DOCTYPE html>
<html lang="en">
   <head>
       <meta charset="utf-8">
       <link rel="shortcut icon" type="image/x-icon" href="../../images/favicon.ico">
       <title>Learnings 30 Aug 2018</title>
   </head>
    <style>

    a.link {
        border-bottom: 1px dashed #a30000;
        color: #a30000;
        text-decoration: none;
    }
    pre {
       width:650px;
       margin: 0 auto;
       font-size:12px; /* 13px will make it bold */
    }
    .code {
        color:white;
        border-radius:5px;
        background-color:#2d3238;
        padding:5px;
        overflow: auto; /* enables horizontal scroll bars to code blocks */
    }
    .center {
		display: inline-block;
		margin: 0 auto;
		max-width: 620px;
	}
    </style>

    <body>
        <pre>
<b>- Today I learned about using Windows Data Types(#)</b>
<b>as part of implementing some of the functions of</b>
<b>Universal CRT(#) like memcpy/memcmp etc.</b>
<b>- Whenever we want to read a memory block as bytes</b>
<b>we need to use the data type BYTE because it is an</b>
<b>alias of 'unsigned char'</b>
<b>- Most of APIs use ULONG instead of DWORD, The</b>
<b>difference between using an unsigned long vs</b>
<b>an unsigned int is that the former mandates at least</b>
<b>32bits in size whereas int only mandates 16bits</b>
<b>in size according to C standard</b>
<b>- SIZE_T is another generic data type which will</b>
<b>guaranteed to hold the native pointer size. So it</b>
<b>is helpful in places where we need counts/sizes</b>

<b>- Practicing Windows NT coding style by implementing</b>
<b>above functions</b>

<b>/*++</b>

<b>Copyright (c) 1989  Microsoft Corporation</b>

<b>Module Name:</b>

    ucrt.c

<b>Abstract:</b>

    This module implements UCRT functions

<b>Author:</b>

    Vineel Kovvuri (vineelko) 29-Aug-2018

<b>Environment:</b>

    User mode only.

<b>--*/</b>

<b>#include &ltWindows.h&gt;</b>
<b>#include &ltstdio.h&gt;</b>

<b>VOID</b>
<b>MemCCpy(</b>
    IN PVOID Dest,
    IN CONST PVOID Src,
    IN DWORD Character,
    IN SIZE_T Count
<b>)</b>
<b>{</b>
    PBYTE DestPtr = (PBYTE)Dest;
    PBYTE SrcPtr = (PBYTE)Src;

    for (SIZE_T i = 0; i < Count; i++) {
        if (*SrcPtr == Character || *DestPtr == Character) {
            break;
        }
        *DestPtr++ = *SrcPtr++;
    }
<b>}</b>

<b>PVOID</b>
<b>MemChr(</b>
    IN CONST PVOID Buffer,
    IN DWORD Character,
    IN SIZE_T Count
<b>)</b>
<b>{</b>
    PBYTE Result = NULL;
    for (SIZE_T i = 0; i < Count; i++) {
        if (((PBYTE)Buffer)[i] == Character) {
            Result = (PBYTE)Buffer;
            break;
        }
    }

    return Result;
<b>}</b>

<b>INT</b>
<b>MemCmp(</b>
    IN CONST PVOID Buffer1,
    IN CONST PVOID Buffer2,
    IN SIZE_T Count
<b>)</b>
<b>{</b>
    for (SIZE_T i = 0; i < Count; i++) {
        BYTE Buffer1Byte = ((PBYTE)Buffer1)[i];
        BYTE Buffer2Byte = ((PBYTE)Buffer2)[i];
        if (Buffer1Byte != Buffer2Byte) {
            return Buffer1Byte - Buffer2Byte;
        }
    }

    return 0;
<b>}</b>

<b>PVOID</b>
<b>MemCpy(</b>
    IN PVOID Dest,
    IN CONST PVOID Source,
    IN SIZE_T Count
<b>)</b>
<b>{</b>
    for (SIZE_T i = 0; i < Count; i++) {
        ((PBYTE)Dest)[i] = ((PBYTE)Source)[i];
    }

    return Dest;
<b>}</b>

<b>- Understood that Windows 10 SDK gets installed</b>
<b>with every latest release of Visual Studio. So</b>
<b>for example for RS4 Windows SDK you just have to</b>
<b>install the latest VS 2017 ver.15.7. Also called</b>
<b>as v141 platform tool set</b>
<b>- The installed Windows 10 SDK will support building</b>
<b>Win32 applications all the way down till Windows 7 SP1</b>
<b>- To explicitly target Windows XP we need to install</b>
<b>"Windows XP support for C++"</b>


<b># Windows Data Types - <a class='link' href='https://docs.microsoft.com/en-us/windows/desktop/winprog/windows-data-types'>https://docs.microsoft.com/en-us/windows/desktop/winprog/windows-data-types</a></b>
<b># Universal C runtime routines by category - <a class='link' href='https://docs.microsoft.com/en-us/cpp/c-runtime-library/buffer-manipulation'>https://docs.microsoft.com/en-us/cpp/c-runtime-library/buffer-manipulation</a></b>

        </pre>
        <div>
            <script src="https://utteranc.es/client.js"
                repo="vineelkovvuri/vineelkovvuri.github.io"
                issue-term="pathname"
                theme="github-light"
                crossorigin="anonymous"
                async>
            </script>
        </div>
    </body>
</html>
